# System Patterns - OnlyFans Chat

## Архитектура системы
OnlyFans Chat построен на основе Next.js с использованием компонентного подхода React и TypeScript для типизации. Архитектура проекта следует принципам чистого кода с разделением ответственности между компонентами и хуками.

### Структура проекта
```
src/
├── app/               # Основные страницы и маршруты приложения
├── components/        # React компоненты
│   ├── chat/          # Компоненты для чата
│   ├── message/       # Компоненты для сообщений
│   ├── ui/            # Переиспользуемые UI компоненты
├── hooks/             # React хуки
├── lib/               # Утилиты и общие функции
├── types/             # TypeScript типы и интерфейсы
├── utils/             # Вспомогательные функции
```

## Основные технические решения

### State Management
- Используется React Context API для глобального состояния
- Локальное состояние управляется через useState и useReducer
- Кастомные хуки для инкапсуляции логики управления состоянием

### Компонентная модель
- Компоненты разделены на презентационные (UI) и контейнерные (логика)
- Используется атомарный дизайн для компонентов UI
- Компоненты чата и сообщений разделены для лучшей переиспользуемости

### Управление данными
- Хуки для управления чатами (`useChats`)
- Хуки для управления сообщениями (`useMessages`)
- Хуки для управления загрузкой медиафайлов (`useMediaUpload`)
- Хуки для отправки сообщений (`useMessageSender`)

### Взаимодействие с API
- Отдельные модули для работы с API
- Кэширование данных на стороне клиента для улучшения производительности
- Пагинация для истории сообщений

## Дизайн-паттерны в использовании

### 1. Custom Hooks Pattern
Используется для инкапсуляции логики и состояния, например:
- `useChats` - управление чатами и авторизацией
- `useMessages` - управление сообщениями и их загрузкой
- `useMediaUpload` - логика загрузки и отправки медиафайлов

### 2. Container/Presentational Pattern
- Разделение логики (контейнеры) от UI (презентационные компоненты)
- Контейнерные компоненты управляют состоянием и передают данные презентационным

### 3. Composition Pattern
- Компоненты построены из более мелких, переиспользуемых частей
- UI абстрагирован для обеспечения консистентности дизайна

### 4. Virtual List Pattern
- Оптимизация рендеринга длинных списков сообщений
- Загрузка дополнительных сообщений при прокрутке

## Отношения между компонентами
- `App` (page.tsx) - корневой компонент, организует основную структуру
- `ChatSidebar` - отвечает за отображение списка чатов
- `MessageList` - отображает сообщения выбранного чата
- `MessageInput` - интерфейс для ввода и отправки сообщений
- `ChatHeader` - отображает информацию о текущем чате 